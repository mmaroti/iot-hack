
#include <math.h>
#include <stdio.h>
#include <stdlib.h>
#include <time.h>

float x0, x1, x2, x3, x4; // inputs samples
float d0, d1, d2, d3;     // 2 input + 2 output compressed
float ls;                 // output loss
float w[23];              // input weights
float wd[23];             // output weights deriv
float z0, z1, z2;         // output samples

void step() {
  float tmp0 = -1.0f;
  float tmp1 = x0;
  float tmp2 = tmp0 * tmp1;
  float tmp3 = w[22];
  float tmp4 = d0;
  float tmp5 = w[13];
  float tmp6 = tmp4 * tmp5;
  float tmp7 = tmp3 + tmp6;
  float tmp8 = w[10];
  float tmp9 = w[0];
  float tmp10 = tmp1 * tmp9;
  float tmp11 = tmp8 + tmp10;
  float tmp12 = x1;
  float tmp13 = w[1];
  float tmp14 = tmp12 * tmp13;
  float tmp15 = tmp11 + tmp14;
  float tmp16 = x2;
  float tmp17 = w[2];
  float tmp18 = tmp16 * tmp17;
  float tmp19 = tmp15 + tmp18;
  float tmp20 = x3;
  float tmp21 = w[3];
  float tmp22 = tmp20 * tmp21;
  float tmp23 = tmp19 + tmp22;
  float tmp24 = x4;
  float tmp25 = w[4];
  float tmp26 = tmp24 * tmp25;
  float tmp27 = tmp23 + tmp26;
  float tmp28 = w[16];
  float tmp29 = tmp27 * tmp28;
  float tmp30 = tmp7 + tmp29;
  float tmp31 = d1;
  float tmp32 = w[18];
  float tmp33 = tmp31 * tmp32;
  float tmp34 = tmp30 + tmp33;
  float tmp35 = w[11];
  float tmp36 = w[5];
  float tmp37 = tmp1 * tmp36;
  float tmp38 = tmp35 + tmp37;
  float tmp39 = w[6];
  float tmp40 = tmp12 * tmp39;
  float tmp41 = tmp38 + tmp40;
  float tmp42 = w[7];
  float tmp43 = tmp16 * tmp42;
  float tmp44 = tmp41 + tmp43;
  float tmp45 = w[8];
  float tmp46 = tmp20 * tmp45;
  float tmp47 = tmp44 + tmp46;
  float tmp48 = w[9];
  float tmp49 = tmp24 * tmp48;
  float tmp50 = tmp47 + tmp49;
  float tmp51 = w[21];
  float tmp52 = tmp50 * tmp51;
  float tmp53 = tmp34 + tmp52;
  float tmp54 = tmp2 + tmp53;
  float tmp55 = tmp54 * tmp54;
  float tmp56 = -1.0f;
  float tmp57 = tmp56 * tmp12;
  float tmp58 = w[12];
  float tmp59 = tmp4 * tmp58;
  float tmp60 = tmp3 + tmp59;
  float tmp61 = w[15];
  float tmp62 = tmp27 * tmp61;
  float tmp63 = tmp60 + tmp62;
  float tmp64 = w[17];
  float tmp65 = tmp31 * tmp64;
  float tmp66 = tmp63 + tmp65;
  float tmp67 = w[20];
  float tmp68 = tmp50 * tmp67;
  float tmp69 = tmp66 + tmp68;
  float tmp70 = tmp57 + tmp69;
  float tmp71 = tmp70 * tmp70;
  float tmp72 = tmp55 + tmp71;
  float tmp73 = -1.0f;
  float tmp74 = tmp73 * tmp16;
  float tmp75 = w[14];
  float tmp76 = tmp27 * tmp75;
  float tmp77 = tmp3 + tmp76;
  float tmp78 = w[19];
  float tmp79 = tmp50 * tmp78;
  float tmp80 = tmp77 + tmp79;
  float tmp81 = tmp74 + tmp80;
  float tmp82 = tmp81 * tmp81;
  float tmp83 = tmp72 + tmp82;
  float tmp84 = 2.0f;
  float tmp85 = tmp3 + tmp76;
  float tmp86 = tmp85 + tmp79;
  float tmp87 = tmp74 + tmp86;
  float tmp88 = tmp84 * tmp87;
  float tmp89 = tmp75 * tmp88;
  float tmp90 = 2.0f;
  float tmp91 = tmp60 + tmp62;
  float tmp92 = tmp91 + tmp65;
  float tmp93 = tmp92 + tmp68;
  float tmp94 = tmp57 + tmp93;
  float tmp95 = tmp90 * tmp94;
  float tmp96 = tmp61 * tmp95;
  float tmp97 = tmp89 + tmp96;
  float tmp98 = 2.0f;
  float tmp99 = tmp3 + tmp6;
  float tmp100 = tmp99 + tmp29;
  float tmp101 = tmp100 + tmp33;
  float tmp102 = tmp101 + tmp52;
  float tmp103 = tmp2 + tmp102;
  float tmp104 = tmp98 * tmp103;
  float tmp105 = tmp28 * tmp104;
  float tmp106 = tmp97 + tmp105;
  float tmp107 = tmp1 * tmp106;
  float tmp108 = tmp12 * tmp106;
  float tmp109 = tmp16 * tmp106;
  float tmp110 = tmp20 * tmp106;
  float tmp111 = tmp24 * tmp106;
  float tmp112 = tmp78 * tmp88;
  float tmp113 = tmp67 * tmp95;
  float tmp114 = tmp112 + tmp113;
  float tmp115 = tmp51 * tmp104;
  float tmp116 = tmp114 + tmp115;
  float tmp117 = tmp1 * tmp116;
  float tmp118 = tmp12 * tmp116;
  float tmp119 = tmp16 * tmp116;
  float tmp120 = tmp20 * tmp116;
  float tmp121 = tmp24 * tmp116;

  ls = tmp83;
  d2 = tmp27;
  d3 = tmp50;
  z0 = tmp53;
  z1 = tmp69;
  z2 = tmp80;
  wd[0] += tmp107;
  wd[1] += tmp108;
  wd[2] += tmp109;
  wd[3] += tmp110;
  wd[4] += tmp111;
  wd[5] += tmp117;
  wd[6] += tmp118;
  wd[7] += tmp119;
  wd[8] += tmp120;
  wd[9] += tmp121;
  wd[10] += tmp106;
  wd[11] += tmp116;
  wd[12] += tmp58;
  wd[13] += tmp5;
  wd[14] += tmp75;
  wd[15] += tmp61;
  wd[16] += tmp28;
  wd[17] += tmp64;
  wd[18] += tmp32;
  wd[19] += tmp78;
  wd[20] += tmp67;
  wd[21] += tmp51;
  wd[22] += tmp3;
}

int data[] = {
    -69, -79, -80, -79, -73, -72, -70, -71, -71, -72, -71, -71, -68, -67, -66,
    -68, -67, -69, -69, -69, -67, -67, -68, -67, -69, -65, -65, -67, -66, -65,
    -64, -65, -69, -69, -69, -65, -66, -64, -64, -64, -64, -63, -61, -61, -59,
    -59, -61, -61, -61, -62, -58, -59, -61, -55, -60, -55, -59, -60, -64, -64,
    -68, -69, -73, -77, -69, -66, -63, -64, -63, -66, -66, -63, -61, -57, -57,
    -57, -57, -58, -57, -59, -53, -51, -60, -56, -56, -57, -55, -56, -53, -52,
    -50, -51, -49, -47, -44, -42, -45, -49, -51, -53, -49, -51, -57, -59, -61,
    -63, -64, -65, -66, -68, -69, -69, -70, -69, -65, -64, -62, -64, -65, -68,
    -71, -74, -76, -76, -76, -69, -67, -66, -64, -62, -60, -62, -63, -65, -65,
    -64, -60, -60, -61, -61, -63, -63, -62, -63, -63, -62, -61, -57, -58, -57,
    -51, -53, -59, -60, -62, -61, -57, -57, -55, -55, -54, -53, -52, -53, -54,
    -53, -53, -51, -51, -53, -51, -53, -52, -52, -50, -44, -45, -47, -44, -47,
    -50, -52, -54, -55, -56, -58, -59, -60, -60, -61, -61, -63, -66, -70, -71,
    -73, -73, -74, -74, -76, -69, -70, -73, -72, -73, -71, -72, -71, -69, -69,
    -68, -69, -68, -69, -68, -70, -71, -69, -67, -65, -64, -65, -63, -64, -63,
    -57, -55, -58, -59, -60, -62, -63, -61, -62, -63, -62, -62, -62, -61, -59,
    -59, -59, -57, -57, -57, -55, -56, -59, -56, -57, -48, -46, -49, -50, -53,
    -54, -54, -55, -54, -55, -54, -56, -57, -60, -58, -56, -54, -54, -56, -57,
    -60, -58, -59, -59, -63, -58, -58, -63, -64, -65, -68, -68, -71, -72, -76,
    -77, -79, -79, -82, -85, -87, -87, -87, -85, -83, -85, -86, -88, -88, -84,
    -74, -67, -65, -64, -63, -64, -64, -64, -63, -63, -67, -68, -70, -68, -67,
    -66, -65, -64, -62, -60, -57, -58, -57, -58, -57, -52, -51, -53, -52, -52,
    -55, -56, -56, -56, -58, -57, -60, -61, -60, -58, -57, -57, -55, -54, -54,
    -55, -58, -57, -53, -52, -47, -49, -56, -58, -54, -55, -56, -57, -57, -60,
    -62, -62, -60, -60, -60, -64, -64, -66, -66, -67, -66, -69, -69, -71, -73,
    -70, -71, -74, -75, -72, -70, -72, -75, -77, -78, -79, -79, -79, -79, -75,
    -75, -71, -69, -68, -68, -68, -70, -71, -70, -70, -65, -66, -69, -68, -68,
    -66, -65, -63, -61, -61, -64, -64, -63, -63, -63, -63, -63, -64, -63, -63,
    -63, -62, -63, -63, -63, -58, -58, -62, -63, -63, -64, -65, -65, -65, -65,
    -65, -63, -63, -63, -64, -65, -65, -66, -65, -66, -65, -66, -65, -64, -63,
    -57, -58, -63, -64, -64, -65, -67, -70, -74, -77, -78, -76, -76, -79, -79,
    -78, -76, -74, -76, -78, -78, -76, -71, -69, -66, -60, -59, -63, -65, -66,
    -66, -66, -66, -65, -66, -68, -68, -69, -68, -70, -69, -66, -66, -66, -65,
    -65, -65, -65, -63, -62, -57, -57, -61, -60, -60, -60, -61, -61, -62, -63,
    -62, -62, -63, -64, -63, -62, -63, -61, -62, -62, -63, -64, -63, -62, -62,
    -60, -61, -65, -66, -65, -67, -65, -65, -65, -66, -66, -67, -67, -67, -67,
    -68, -67, -67, -65, -64, -64, -64, -64, -64, -62, -59, -58, -61, -60, -62,
    -65, -65, -68, -72, -72, -72, -71, -68, -66, -66, -65, -68, -64, -62, -60,
    -59, -59, -62, -62, -62, -59, -61, -65, -67, -69, -67, -66, -65, -64, -64,
    -64, -63, -63, -62, -62, -62, -63, -65, -65, -66, -68, -67, -68, -69, -69,
    -66, -66, -69, -68, -67, -66, -64, -62, -63, -64, -62, -60, -57, -56, -57,
    -60, -60, -59, -57, -55, -54, -54, -56, -55, -53, -46, -50, -55, -60, -61,
    -59, -57, -56, -55, -54, -55, -56, -58, -59, -62, -63, -64, -63, -60, -56,
    -54, -53, -49, -47, -49, -45, -45, -49, -48, -47, -49, -50, -52, -55, -57,
    -56, -55, -58, -59, -61, -61, -61, -59, -59, -57, -56, -55, -57, -58, -59,
    -55, -53, -58, -58, -59, -60, -62, -61, -62, -63, -62, -59, -56, -59, -59,
    -60, -59, -61, -62, -62, -62, -63, -65, -66, -65, -59, -56, -60, -59, -60,
    -58, -58, -58, -57, -59, -59, -61, -60, -59, -57, -58, -57, -57, -60, -63,
    -65, -68, -72, -70, -66, -61, -59, -61, -60, -58, -56, -58, -57, -57, -57,
    -58, -58, -58, -61, -62, -63, -63, -62, -61, -62, -61, -62, -62, -64, -62,
    -57, -58, -62, -60, -60, -61, -62, -62, -64, -64, -65, -65, -65, -65, -64,
    -64, -63, -63, -64, -65, -66, -67, -67, -69, -69, -62, -61, -63, -59, -57,
    -57, -52, -51, -52, -51, -52, -49, -51, -51, -51, -51, -52, -53, -55, -58,
    -57, -56, -53, -52, -51, -45, -43, -51, -53, -55, -60, -59, -59, -58, -55,
    -52, -52, -52, -51, -48, -50, -50, -50, -50, -51, -49, -50, -53, -54, -57,
    -55, -54, -60, -60, -61, -63, -63, -64, -63, -63, -62, -62, -63, -62, -63,
    -63, -63, -63, -62, -61, -60, -62, -63, -62, -61, -57, -57, -63, -63, -63,
    -64, -64, -64, -64, -63, -64, -66, -66, -66, -66, -66, -67, -66, -66, -66,
    -65, -65, -65, -65, -63, -60, -60, -63, -62, -62, -63, -63, -63, -61, -58,
    -56, -54, -56, -59, -61, -64, -64, -66, -61, -60, -57, -56, -57, -58, -59,
    -55, -56, -62, -63, -62, -62, -63, -62, -60, -60, -61, -62, -63, -63, -61,
    -59, -56, -55, -57, -58, -61, -63, -63, -63, -63, -61, -60, -64, -66, -66,
    -67, -68, -67, -66, -66, -65, -66, -66, -66, -67, -67, -67, -68, -68, -68,
    -68, -67, -69, -68, -70, -67, -63, -66, -66, -67, -64, -63, -63, -62, -59,
    -59, -59, -58, -61, -61, -61, -61, -61, -62, -64, -65, -65, -63, -62, -60,
    -57, -59, -63, -62, -61, -60, -59, -57, -56, -54, -52, -49, -51, -52, -53,
    -53, -54, -52, -55, -53, -55, -56, -56, -58, -56, -52, -52, -58, -59, -58,
    -60, -61, -63, -65, -66, -65, -63, -62, -62, -64, -64, -63, -64, -63, -63,
    -63, -64, -66, -68, -68, -63, -63, -66, -64, -64, -63, -61, -59, -56, -55,
    -57, -56, -60, -61, -61, -61, -59, -60, -60, -62, -63, -64, -64, -62, -61,
    -53, -51, -53, -52, -50, -49, -50, -51, -49, -49, -49, -50, -50, -52, -54,
    -54, -56, -59, -60, -60, -60, -60, -59, -55, -54, -52, -52, -58, -57, -60,
    -61, -63, -63, -62, -61, -62, -62, -63, -62, -62, -62, -60, -62, -60, -59,
    -59, -60, -60, -61, -63, -57, -58, -63, -63, -61, -63, -61, -61, -63, -65,
    -65, -67, -67, -65, -64, -62, -62, -61, -61, -59, -58, -59, -58, -59, -57,
    -53, -51, -57, -60, -66, -73, -73, -71, -67, -56, -49, -45, -39, -38, -40,
    -45, -46, -51, -54, -58, -57, -55, -52, -49, -44, -37, -34, -38, -39, -39,
    -40, -41, -41, -42, -42, -43, -44, -44, -40, -38, -37, -34, -35, -36, -39,
    -39, -39, -37, -38, -39, -34, -37, -42, -44, -43, -45, -45, -44, -45, -47,
    -47, -49, -49, -46, -47, -51, -52, -51, -52, -54, -52, -53, -54, -56, -57,
    -51, -50, -55, -55, -57, -56, -57, -60, -60, -61, -62, -63, -65, -68, -70,
    -70, -68, -66, -67, -65, -63, -63, -62, -63, -63, -58, -57, -60, -60, -59,
    -58, -55, -51, -50, -50, -51, -51, -53, -55, -56, -45, -61, -60, -51, -56,
    -49, -41, -53, -55, -58, -55, -47, -47, -47, -51, -49, -51, -51, -50, -49,
    -49, -45, -52, -52, -60, -56, -53, -55, -54, -56, -58, -57, -55, -54, -55,
    -49, -49, -51, -51, -51, -48, -54, -44, -36, -43, -46, -60, -64, -58, -61,
    -60, -60, -63, -67, -72, -75, -71, -71, -75, -78, -76, -75, -74, -74, -71,
    -72, -74, -74, -73, -74, -74, -77, -75, -74, -74, -70, -69, -67, -65, -63,
    -64, -63, -64, -64, -71, -66, -66, -64, -65, -65, -66, -66, -67, -64, -62,
    -59, -57, -58, -62, -63, -63, -64, -64, -64, -65, -66, -65, -64, -62, -62,
    -58, -57, -60, -57, -54, -50, -48, -48, -48, -49, -47, -49, -51, -55, -58,
    -62, -66, -69, -73, -74, -77, -78, -80, -75, -72, -66, -68, -73, -75, -74,
    -71, -70, -70, -70, -69, -70, -68, -66, -66, -67, -67, -69, -65, -67, -66,
    -67, -71, -72, -67, -64, -57, -58, -65, -62, -62, -62, -64, -64, -67, -66,
    -69, -68, -68, -68, -68, -66, -66, -64, -62, -61, -60, -58, -58, -56, -53,
    -47, -47, -52, -54, -56, -56, -57, -58, -60, -63, -64, -63, -63, -64, -67,
    -69, -69, -67, -67, -66, -66, -70, -73, -76, -78, -77, -75, -80, -80, -80,
    -81, -82, -81, -78, -78, -77, -78, -78, -77, -76, -75, -74, -69, -68, -68,
    -70, -68, -68, -70, -71, -67, -66, -70, -70, -68, -69, -67, -67, -66, -65,
    -63, -63, -60, -61, -60, -59, -59, -57, -56, -54, -52, -51, -52, -53, -55,
    -52, -53, -58, -59, -57, -55, -54, -53, -56, -56, -56, -54, -55, -56, -58,
    -63, -63, -62, -59, -59, -63, -67, -67, -70, -72, -70, -75, -82, -76, -79,
    -77, -75, -76, -73, -72, -72, -75, -80, -83, -84, -80, -77, -77, -76, -77,
    -77, -74, -75, -73, -74, -67, -67, -71, -68, -68, -68, -70, -70, -69, -68,
    -68, -66, -66, -67, -67, -68, -71, -72, -71, -74, -77, -80, -82, -80, -79,
    -73, -70, -71, -70, -65, -64, -63, -62, -61, -63, -64, -63, -66, -64, -65,
    -64, -64, -67, -70, -69, -67, -65, -65, -67, -68, -64, -65, -70, -72, -70,
    -68, -67, -68, -68, -75, -78, -82, -82, -85, -86, -89, -88, -81, -78, -74,
    -70, -70, -69, -71, -72, -69, -69, -76, -77, -77, -78, -80, -76, -75, -78,
    -76, -75, -71, -68, -65, -62, -62, -63, -64, -66, -68, -68, -65, -65, -68,
    -68, -71, -74, -72, -70, -71, -73, -74, -77, -77, -80, -81, -80, -78, -78,
    -79, -79, -79, -76, -72, -70, -71, -73, -74, -74, -68, -69, -76, -77, -82,
    -81, -79, -78, -74, -73, -74, -76, -78, -80, -81, -78, -77, -78, -80, -81,
    -82, -80, -79, -76, -75, -71, -71, -78, -79, -79, -82, -80, -79, -79, -80,
    -78, -73, -69, -62, -63, -63, -61, -59, -56, -54, -54, -60, -63, -66, -69,
    -67, -65, -70, -69, -71, -72, -70, -67, -66, -66, -68, -70, -69, -68, -69,
    -71, -75, -75, -75, -74, -72, -70, -70, -73, -76, -72, -72, -74, -72, -76,
    -78, -78, -75, -71, -67, -65, -64, -65, -66, -68, -70, -71, -70, -70, -69,
    -71, -71, -71, -69, -70, -66, -66, -67, -67, -66, -61, -63, -64, -64, -63,
    -62, -57, -54, -55, -56, -56, -58, -60, -61, -61, -61, -62, -63, -63, -64,
    -59, -58, -61, -63, -60, -61, -60, -60, -59, -56, -60, -59, -60, -60, -61,
    -61, -62, -61, -62, -62, -60, -58, -58, -54, -54, -50, -51, -57, -58, -56,
    -55, -55, -56, -58, -56, -52, -54, -51, -53, -53, -56, -59, -61, -63, -65,
    -68, -70, -69, -67, -67, -65, -65, -68, -69, -71, -71, -72, -72, -72, -73,
    -72, -67, -64, -62, -61, -60, -57, -59, -59, -62, -62, -62, -63, -62, -63,
    -60, -62, -65, -65, -67, -67, -66, -67, -66, -66, -66, -66, -65, -64, -51,
    -72, -63, -53, -78, -56, -74, -77, -45, -77, -71, -64, -70, -75, -67, -70,
    -67, -66, -66, -66, -68, -64, -66, -67, -68, -71, -73, -75, -75, -74, -73,
    -71, -68, -67, -68, -69, -66, -67, -69, -67, -66, -66, -67, -66, -69, -72,
    -72, -69, -65, -60, -56, -55, -47, -48, -46, -51, -56, -59, -64, -59, -58,
    -54, -53, -59, -61, -61, -60, -57, -58, -61, -64, -66, -65, -66, -62, -62,
    -60, -61, -62, -61, -62, -61, -60, -60, -59, -61, -55, -53, -57, -56, -55,
    -56, -55, -55, -55, -53, -53, -51, -51, -53, -55, -56, -56, -58, -57, -59,
    -61, -62, -63, -63, -63, -57, -56, -59, -61, -60, -61, -62, -63, -64, -64,
    -65, -68, -68, -67, -67, -69, -65, -64, -64, -63, -63, -63, -65, -65, -64,
    -58, -55, -61, -62, -61, -59, -56, -52, -51, -50, -51, -51, -52, -52, -53,
    -55, -60, -62, -61, -59, -61, -61, -59, -60, -58, -52, -51, -56, -56, -56,
    -56, -57, -58, -58, -59, -60, -60, -61, -62, -65, -63, -64, -64, -64, -64,
    -64, -64, -62, -63, -65, -60, -61, -65, -64, -64, -64, -63, -62, -61, -61,
    -62, -63, -63, -64, -62, -63, -62, -60, -60, -59, -58, -59, -59, -63, -64,
    -59, -60, -63, -60, -57, -52, -53, -53, -52, -55, -55, -57, -59, -60, -61,
    -60, -58, -57, -54, -51, -51, -52, -54, -59, -61, -57, -59, -62, -60, -57,
    -52, -51, -49, -48, -49, -49, -49, -45, -47, -49, -50, -50, -48, -49, -49,
    -49, -50, -52, -50, -50, -44, -46, -53, -54, -54, -54, -54, -54, -56, -57,
    -57, -58, -57, -58, -58, -59, -60, -59, -57, -57, -56, -57, -58, -58, -57,
    -49, -47, -52, -54, -55, -59, -60, -61, -61, -60, -58, -57, -54, -52, -54,
    -54, -54, -52, -51, -49, -50, -49, -46, -45, -45, -39, -40, -44, -43, -40,
    -41, -45, -49, -49, -48, -45, -44, -42, -42, -42, -43, -41, -42, -43, -45,
    -46, -46, -44, -42, -39, -35, -35, -41, -43, -45, -46, -48, -48, -48, -47,
    -48, -48, -48, -47, -45, -46, -46, -47, -49, -51, -53, -54, -55, -58, -59,
    -56, -58, -63, -63, -63, -63, -62, -62, -63, -62, -64, -63, -64, -64, -65,
    -69, -70, -67, -65, -64, -63, -63, -61, -60, -58, -54, -57, -60, -58, -57,
    -54, -53, -54, -57, -58, -57, -58, -56, -56, -54, -51, -47, -44, -43, -43,
    -45, -44, -46, -49, -53, -50, -51, -56, -55, -53, -55, -54, -52, -53, -53,
    -54, -55, -56, -54, -53, -52, -51, -52, -50, -50, -51, -54, -57, -59, -58,
    -52, -51, -54, -58, -61, -62, -63, -61, -60, -58, -55, -55, -56, -57, -62,
    -66, -72, -75, -76, -76, -74, -70, -65, -60, -58, -50, -52, -57, -61, -61,
    -61, -62, -61, -59, -58, -55, -50, -48, -45, -40, -39, -41, -42, -43, -43,
    -45, -47, -48, -49, -48, -44, -44, -51, -54, -54, -57, -57, -57, -54, -55,
    -51, -52, -51, -49, -50, -48, -47, -48, -47, -47, -49, -50, -51, -51, -54,
    -50, -50, -56, -59, -58, -59, -62, -62, -66, -66, -66, -65, -64, -64, -63,
    -63, -63, -64, -64, -67, -70, -72, -72, -69, -68, -62, -58, -60, -59, -61,
    -60, -60, -59, -57, -56, -54, -53, -52, -52, -51, -49, -50, -53, -56, -56,
    -55, -54, -53, -52, -53, -51, -48, -50, -48, -49, -51, -52, -53, -56, -54,
    -53, -54, -56, -59, -62, -64, -64, -65, -65, -64, -64, -66, -65, -63, -62,
    -58, -58, -61, -63, -65, -66, -66, -65, -64, -69, -72, -71, -75, -74, -70,
    -65, -61, -61, -61, -61, -62, -63, -63, -63};

void print_input_output() {
  printf("input\toutput");
  int len = sizeof(data) / sizeof(data[0]);
  for (int s = 0; s + 2 < len; s += 3) {
    x0 = x3;
    x1 = x4;
    x2 = data[s] * 0.01f;
    x3 = data[s + 1] * 0.01f;
    x4 = data[s + 2] * 0.01f;
    d0 = d2;
    d1 = d3;

    step();
    if (s == 0)
      continue;

    printf("%.2f\t%0.2f\n", x0, z0);
    printf("%.2f\t%0.2f\n", x1, z1);
    printf("%.2f\t%0.2f\n", x2, z2);
  }
}

void train() {
  for (int i = 0; i < 23; i++) {
    w[i] = ((rand() % 2001) - 1000) * 0.001;
    wd[i] = 0.0f;
  }

  int len = sizeof(data) / sizeof(data[0]);
  printf("data len: %d\n", len);
  for (int n = 0; n < 100000; n += 1) {
    float err = 0.0f;
    for (int s = 0; s + 2 < len; s += 3) {
      x0 = x3;
      x1 = x4;
      x2 = data[s] * 0.01f;
      x3 = data[s + 1] * 0.01f;
      x4 = data[s + 2] * 0.01f;
      d0 = d2;
      d1 = d3;

      step();
      if (s == 0)
        continue;
      err += ls;
    }

    float wd_sum = 0.0f;
    for (int i = 0; i < 23; i++) {
      wd_sum += fabs(wd[i]);
      w[i] -= 0.000000001f * wd[i];
    }

    if (wd_sum > 1000.0f) {
      for (int i = 0; i < 23; i++)
        wd[i] = 0.0f;
    }

    if (n % 1000 == 0)
      printf("epoch %d, total loss %.1f, wd_sum %.1f\n", n, err, wd_sum);
  }

  print_input_output();
}

void check_driv() {
  x0 = 1.0f;
  x1 = 2.0f;
  x2 = -3.0f;
  x3 = 4.0;
  x4 = -1.0;

  d0 = 2.0f;
  d1 = -1.0f;

  for (int i = 0; i < 23; i++) {
    int a = rand() % 2001;
    w[i] = (a - 1000) * 0.001f;
    wd[i] = 0.0f;
    printf("%.1f\n", w[i]);
  }

  step();
  printf("%.2f\n", ls);

  printf("backprop: %.2f\n", wd[2]);

  float wd2 = ls;
  w[2] += 0.01f;
  step();
  w[2] -= 0.01f;
  wd2 = (ls - wd2) / 0.01f;
  printf("numeric: %.2f\n", wd2);
}

int main() {
  srand(time(NULL));
  train();
  // check_driv();
  return 0;
}